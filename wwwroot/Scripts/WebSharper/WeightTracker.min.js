(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;b=a.WeightTracker=a.WeightTracker||{};c=b.Client=b.Client||{};d=c.Weight=c.Weight||{};e=a.StartupCode$WeightTracker$Client=a.StartupCode$WeightTracker$Client||{};f=a.WeightTracker_Templates=a.WeightTracker_Templates||{};g=a.WebSharper;h=g&&g.List;i=g&&g.Enumerator;j=g&&g.Charting;k=j&&j.Chart;l=j&&j.Pervasives;m=g&&g.UI;n=m&&m.Templating;o=n&&n.Runtime;p=o&&o.Server;q=p&&p.ProviderBuilder;r=p&&p.Handler;s=p&&p.TemplateInstance;t=m&&m.Var$1;u=m&&m.ListModel;v=m&&m.Doc;w=g&&g.Seq;x=j&&j.Renderers;y=x&&x.ChartJs;z=m&&m.Client;A=z&&z.Templates;d.Create=function(B,C,D){return d.New(B,C,D);};d.New=function(B,C,D){return{WeightValue:B,WeightDate:C,WeightNotes:D};};c.Main$73$20=function(B,C,D){return function(E){var F,G,H,I;if(E.Vars.Hole("inputweight").$1.Get()===""||E.Vars.Hole("inputdate").$1.Get()===""||!B(E.Vars.Hole("inputweight").$1.Get()))C.Set("Please input a valid value");else{C.Set("Ok.");F=d.Create(E.Vars.Hole("inputweight").$1.Get(),E.Vars.Hole("inputdate").$1.Get(),E.Vars.Hole("inputnotes").$1.Get());c.weightLog().Append(F);D.Append(d.Create(E.Vars.Hole("inputweight").$1.Get(),E.Vars.Hole("inputdate").$1.Get(),E.Vars.Hole("inputnotes").$1.Get()));c.datah().Clear();D.Iter(function(J){c.datah().Append([J.WeightDate,a.Number(J.WeightValue)]);});c.set_dataty(h.T.Empty);G=i.Get(D);try{while(G.MoveNext()){H=G.Current();c.set_dataty((I=h.ofArray([[H.WeightDate,a.Number(H.WeightValue)]]),h.append(c.dataty(),I)));}}finally{if(typeof G=="object"&&"Dispose"in G)G.Dispose();}k.Line$1(c.dataty()).__WithStrokeColor(new l.Color({$:2,$0:"Blue"})).__UpdateData(10,function(J){return J+20;});}};};c.Main=function(){var B,C,D,E,F,G,H,I,J,K,L,M,N,Q,R,S,T;function O(U){var V,W,X,Y,Z,_0;return(V=(W=(X=(Y=new q.New$1(),(Y.h.push({$:1,$0:"theweight",$1:U.WeightValue}),Y)),(X.h.push({$:1,$0:"thedate",$1:U.WeightDate}),X)),(W.h.push({$:1,$0:"thenotes",$1:U.WeightNotes}),W)),(Z=r.CompleteHoles(V.k,V.h,[]),(_0=new s.New(Z[1],f.input(Z[0])),V.i=_0,_0))).get_Doc();}function P(U){var V,W;return(V=0,[(W=a.Number(U),a.isNaN(W)?false:(V=W,true)),V])[0];}t.Create$1("");Q=u.FromSeq([]);Q.Clear();c.weightLog().Iter(function(U){Q.Append(d.Create(U.WeightValue,U.WeightDate,U.WeightNotes));});R=i.Get(Q);try{while(R.MoveNext()){S=R.Current();c.set_dataty((T=h.ofArray([[S.WeightDate,a.Number(S.WeightValue)]]),h.append(c.dataty(),T)));}}finally{if(typeof R=="object"&&"Dispose"in R)R.Dispose();}C=v.BindView(function(U){return v.Concat(w.map(O,w.sortBy(function(V){return V.WeightDate;},U)));},Q.v);D=k.Combine([k.Line$1(c.dataty()).__WithStrokeColor(new l.Color({$:2,$0:"Blue"})).__WithPointColor(new l.Color({$:2,$0:"Blue"}))]);E=t.Create$1("");return(F=(G=E.get_View(),H=(I=y.Render$2(D,null,null,{$:1,$0:10}),J=(K=(L=new q.New$1(),L.h.push({$:0,$0:"log",$1:C}),L),K.h.push(r.EventQ2(K.k,"onsend",function(){return K.i;},function(U){var V,W,X,Y;if(U.Vars.Hole("inputweight").$1.Get()===""||U.Vars.Hole("inputdate").$1.Get()===""||!P(U.Vars.Hole("inputweight").$1.Get()))E.Set("Please input a valid value");else{E.Set("Ok.");V=d.Create(U.Vars.Hole("inputweight").$1.Get(),U.Vars.Hole("inputdate").$1.Get(),U.Vars.Hole("inputnotes").$1.Get());c.weightLog().Append(V);Q.Append(d.Create(U.Vars.Hole("inputweight").$1.Get(),U.Vars.Hole("inputdate").$1.Get(),U.Vars.Hole("inputnotes").$1.Get()));c.datah().Clear();Q.Iter(function(Z){c.datah().Append([Z.WeightDate,a.Number(Z.WeightValue)]);});c.set_dataty(h.T.Empty);W=i.Get(Q);try{while(W.MoveNext()){X=W.Current();c.set_dataty((Y=h.ofArray([[X.WeightDate,a.Number(X.WeightValue)]]),h.append(c.dataty(),Y)));}}finally{if(typeof W=="object"&&"Dispose"in W)W.Dispose();}k.Line$1(c.dataty()).__WithStrokeColor(new l.Color({$:2,$0:"Blue"})).__UpdateData(10,function(Z){return Z+20;});}})),K),J.h.push({$:0,$0:"graph",$1:I}),J),H.h.push({$:2,$0:"msg",$1:G}),H),M=r.CompleteHoles(F.k,F.h,[["inputweight",0],["inputdate",0],["inputnotes",0]]),N=new s.New(M[1],f.mainform(M[0])),F.i=N,N).get_Doc();};c.dataty=function(){e.$cctor();return e.dataty;};c.set_dataty=function(B){e.$cctor();e.dataty=B;};c.datah=function(){e.$cctor();return e.datah;};c.weightLog=function(){e.$cctor();return e.weightLog;};e.$cctor=function(){e.$cctor=a.ignore;e.weightLog=u.FromSeq([d.Create("75.2","2022-05-18",""),d.Create("77.2","2022-05-19","Party"),d.Create("76.2","2022-05-20",""),d.Create("75.1","2022-05-21",""),d.Create("78.1","2022-05-22","Drunk too much"),d.Create("77.2","2022-05-23","")]);e.datah=u.FromSeq([]);c.weightLog().Iter(function(B){c.datah().Append([a.String(B.WeightDate),a.Number(B.WeightValue)]);});e.dataty=h.T.Empty;};f.input=function(B){A.LoadLocalTemplates("main");return B?A.NamedTemplate("main",{$:1,$0:"input"},B):void 0;};f.mainform=function(B){A.LoadLocalTemplates("main");return B?A.NamedTemplate("main",{$:1,$0:"mainform"},B):void 0;};}(self));
