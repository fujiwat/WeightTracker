(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;b=a.WeightTracker=a.WeightTracker||{};c=b.Client=b.Client||{};d=c.Weight=c.Weight||{};e=a.StartupCode$WeightTracker$Client=a.StartupCode$WeightTracker$Client||{};f=a.WeightTracker_Templates=a.WeightTracker_Templates||{};g=a.WebSharper;h=g&&g.List;i=g&&g.UI;j=i&&i.Templating;k=j&&j.Runtime;l=k&&k.Server;m=l&&l.ProviderBuilder;n=l&&l.Handler;o=l&&l.TemplateInstance;p=i&&i.Var$1;q=i&&i.ListModel;r=g&&g.Enumerator;s=i&&i.Doc;t=g&&g.Seq;u=g&&g.Charting;v=u&&u.Chart;w=u&&u.Pervasives;x=u&&u.Renderers;y=x&&x.ChartJs;z=i&&i.Client;A=z&&z.Templates;d.Create=function(B,C,D){return d.New(B,C,D);};d.New=function(B,C,D){return{WeightValue:B,WeightDate:C,WeightNotes:D};};c.Main$92$20=function(B,C,D){return function(E){var F,G;if(E.Vars.Hole("inputweight").$1.Get()===""||E.Vars.Hole("inputdate").$1.Get()===""||!B(E.Vars.Hole("inputweight").$1.Get()))C.Set("Please input a valid value");else{C.Set("Ok.");F=d.Create(E.Vars.Hole("inputweight").$1.Get(),E.Vars.Hole("inputdate").$1.Get(),E.Vars.Hole("inputnotes").$1.Get());c.weightLog().Append(F);D.Append(d.Create(E.Vars.Hole("inputweight").$1.Get(),E.Vars.Hole("inputdate").$1.Get(),E.Vars.Hole("inputnotes").$1.Get()));E.Vars.Hole("inputweight").$1.Get();D.Iter(function(H){c.datah().Append([H.WeightDate,a.Number(H.WeightValue)]);});c.set_dataty((G=h.ofArray([["chou",5]]),h.append(c.dataty(),G)));C.Set("Ok.");}};};c.Main=function(){var B,C,D,E,F,G,H,I,J,K,L,M,N,Q,R,S,T,U,V,W,X,Y,Z;function O(_0){var _1,_2,_3,_4,_5,_6;return(_1=(_2=(_3=(_4=new m.New$1(),(_4.h.push({$:1,$0:"theweight",$1:_0.WeightValue}),_4)),(_3.h.push({$:1,$0:"thedate",$1:_0.WeightDate}),_3)),(_2.h.push({$:1,$0:"thenotes",$1:_0.WeightNotes}),_2)),(_5=n.CompleteHoles(_1.k,_1.h,[]),(_6=new o.New(_5[1],f.input(_5[0])),_1.i=_6,_6))).get_Doc();}function P(_0){var _1,_2;return(_1=0,[(_2=a.Number(_0),a.isNaN(_2)?false:(_1=_2,true)),_1])[0];}p.Create$1("");Q=q.FromSeq([]);Q.Clear();c.weightLog().Iter(function(_0){Q.Append(d.Create(_0.WeightValue,_0.WeightDate,_0.WeightNotes));});R=r.Get(Q);try{while(R.MoveNext()){S=R.Current();c.set_dataty((T=h.ofArray([[S.WeightDate,a.Number(S.WeightValue)]]),h.append(c.dataty(),T)));}}finally{if(typeof R=="object"&&"Dispose"in R)R.Dispose();}U=r.Get(Q);try{while(U.MoveNext()){V=U.Current();if(a.Number(V.WeightValue)<c.minWeight())c.set_minWeight(a.Number(V.WeightValue));if(c.maxWeight()<a.Number(V.WeightValue))c.set_maxWeight(a.Number(V.WeightValue));}}finally{if(typeof U=="object"&&"Dispose"in U)U.Dispose();}W=r.Get(Q);try{while(W.MoveNext()){X=W.Current();c.set_dataMin((Y=h.ofArray([[X.WeightDate,c.minWeight()-(c.maxWeight()-c.minWeight())]]),h.append(c.dataMin(),Y)));c.set_dataMax((Z=h.ofArray([[X.WeightDate,c.maxWeight()+(c.maxWeight()-c.minWeight())]]),h.append(c.dataMax(),Z)));}}finally{if(typeof W=="object"&&"Dispose"in W)W.Dispose();}C=s.BindView(function(_0){return s.Concat(t.map(O,t.sortBy(function(_1){return _1.WeightDate;},_0)));},Q.v);D=v.Combine([v.Line$1(c.dataty()).__WithStrokeColor(new w.Color({$:2,$0:"Blue"})).__WithPointColor(new w.Color({$:2,$0:"Blue"})),v.Line$1(c.dataMin()).__WithStrokeColor(new w.Color({$:2,$0:"ghostwhite"})).__WithPointColor(new w.Color({$:2,$0:"ghostwhite"})),v.Line$1(c.dataMax()).__WithStrokeColor(new w.Color({$:2,$0:"ghostwhite"})).__WithPointColor(new w.Color({$:2,$0:"ghostwhite"}))]);E=p.Create$1("");return(F=(G=E.get_View(),H=(I=y.Render$2(D,null,null,{$:1,$0:10}),J=(K=(L=new m.New$1(),L.h.push({$:0,$0:"log",$1:C}),L),K.h.push(n.EventQ2(K.k,"onsend",function(){return K.i;},function(_0){var _1,_2;if(_0.Vars.Hole("inputweight").$1.Get()===""||_0.Vars.Hole("inputdate").$1.Get()===""||!P(_0.Vars.Hole("inputweight").$1.Get()))E.Set("Please input a valid value");else{E.Set("Ok.");_1=d.Create(_0.Vars.Hole("inputweight").$1.Get(),_0.Vars.Hole("inputdate").$1.Get(),_0.Vars.Hole("inputnotes").$1.Get());c.weightLog().Append(_1);Q.Append(d.Create(_0.Vars.Hole("inputweight").$1.Get(),_0.Vars.Hole("inputdate").$1.Get(),_0.Vars.Hole("inputnotes").$1.Get()));_0.Vars.Hole("inputweight").$1.Get();Q.Iter(function(_3){c.datah().Append([_3.WeightDate,a.Number(_3.WeightValue)]);});c.set_dataty((_2=h.ofArray([["chou",5]]),h.append(c.dataty(),_2)));E.Set("Ok.");}})),K),J.h.push({$:0,$0:"graph",$1:I}),J),H.h.push({$:2,$0:"msg",$1:G}),H),M=n.CompleteHoles(F.k,F.h,[["inputweight",0],["inputdate",0],["inputnotes",0]]),N=new o.New(M[1],f.mainform(M[0])),F.i=N,N).get_Doc();};c.dataMax=function(){e.$cctor();return e.dataMax;};c.set_dataMax=function(B){e.$cctor();e.dataMax=B;};c.dataMin=function(){e.$cctor();return e.dataMin;};c.set_dataMin=function(B){e.$cctor();e.dataMin=B;};c.maxWeight=function(){e.$cctor();return e.maxWeight;};c.set_maxWeight=function(B){e.$cctor();e.maxWeight=B;};c.minWeight=function(){e.$cctor();return e.minWeight;};c.set_minWeight=function(B){e.$cctor();e.minWeight=B;};c.dataty=function(){e.$cctor();return e.dataty;};c.set_dataty=function(B){e.$cctor();e.dataty=B;};c.datah=function(){e.$cctor();return e.datah;};c.weightLog=function(){e.$cctor();return e.weightLog;};e.$cctor=function(){e.$cctor=a.ignore;e.weightLog=q.FromSeq([d.Create("75.2","2022-05-18",""),d.Create("77.2","2022-05-19","Party"),d.Create("76.2","2022-05-20",""),d.Create("75.1","2022-05-21",""),d.Create("78.1","2022-05-22","Drunk too much"),d.Create("77.2","2022-05-23","")]);e.datah=q.FromSeq([]);c.weightLog().Iter(function(B){c.datah().Append([a.String(B.WeightDate),a.Number(B.WeightValue)]);});e.dataty=h.T.Empty;e.minWeight=9999;e.maxWeight=0;e.dataMin=h.T.Empty;e.dataMax=h.T.Empty;};f.input=function(B){A.LoadLocalTemplates("main");return B?A.NamedTemplate("main",{$:1,$0:"input"},B):void 0;};f.mainform=function(B){A.LoadLocalTemplates("main");return B?A.NamedTemplate("main",{$:1,$0:"mainform"},B):void 0;};}(self));
